<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>QiMessaging (メモリに出力)</title>
    <style>
    @CHARSET "UTF-8";
    *{
        margin: 0;
        padding: 0;
    }
    .country{
        position: relative;
        width: 100vw;
        height: 100vh;
    }
    .country .img{
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
    }
    .country .message{
        text-align: center;
        position: absolute;
        bottom: 5%;
        font-size: 120px;
        width: 100%;
        color: white;
        background: rgba(0,0,0,0.3);
        padding: 20px 10%;
        box-sizing: border-box;
    }
    
    .buttons{
        position: absolute;
        right: 3%;
        top: 20%;
    }
    .button{
            background: transparent;
    border: white solid 7px;
    padding: 30px;
    width: 100%;
    color: white;
    font-size: 50px;
    margin-bottom: 40px;
    font-weight: bold;
    box-shadow: 0px 5px 7px 4px rgba(0,0,0,0.3);
    }

    </style>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="/libs/qimessaging/1.0/qimessaging.js"></script>
    <script>
      var session = new QiSession();
      
      function raise(lang) {
        session.service("ALMemory").done(function (ALMemory) {
          console.log("ALMemory取得成功");
          ALMemory.raiseEvent("index/" + lang, "押したね");
        });
      }
      
      function subscribe(label, callback) {
        session.service("ALMemory").done(function (ALMemory) {
            alert('test');
          console.log("ALMemory取得成功");
          ALMemory.subscriber(label).done(function(subscriber) {
            subscriber.signal.connect(callback);
          });
        });
      }
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>

    <script>
    var socket = io.connect('https://jasia.au-syd.mybluemix.net:/test');
    
    var events = {
        japanese: 'Japanese',
        english: 'English',
        korean: 'Korean',
        chinese: 'Chinese',
        finnish: 'Finnish',
        spanish: 'Spanish',
        french: 'French'
    };
    
    var langs = [
        'japanese',
        'english',
        'chinese',
        'finnish'
    ];
    
    var langsMessage = {
        japanese: 'ちょっと待ってな～',
        english: 'I want to buy souvenirs',
        korean: '기념품을 사고 싶은',
        chinese: '我想买纪念品',
        spanish: 'Quiero comprar recuerdos',
        french: 'Je veux acheter des souvenirs',
        finnish: 'Haluan ostaa matkamuistoja'
    }   
    
    var button1 = {
        japanese: 'ちょっと待ってな～',
        english: 'Wi-fi around',
        chinese: 'Wi-fi 周围附近',
        finnish: 'wifi ympäri'
    }  
    
    var button2 = {
        japanese: 'ちょっと待ってな～',
        english: 'Restaurants',
        chinese: '餐厅',
        finnish: 'ravintolat'
    }
 
    socket.on('my response', function(data) {
        $('.country .img').attr('src', 'img/' + data.data.lang + '.jpg');
        $('.country .message').text(langsMessage[data.data.lang]);
        $('.buttons .button1').text(button1[data.data.lang]);
        $('.buttons .button2').text(button2[data.data.lang]);
        raise(data.data.lang);
    });
    
    subscribe("index/getMood", function(res){
        alert(JSON.stringify(res));
    });
    </script>
  </head>
  <body>
      <div class="country">
        <img src="" class="img" alt="">
        <p class="message"></div>
        <div class="buttons">
            <button class="button button1"></button>
            <button class="button button2"></button>
            <!--<button class="button button3"></button>-->
        </div>
      </div>
  </body>
</html>
